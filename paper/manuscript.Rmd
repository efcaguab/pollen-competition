---
title: "Community context determines competition/facilitation trade-offs in pollination systems"
author: 
  - "E. Fernando Cagua^1^ ([efc29@uclive.ac.nz](mailto:efc29@uclive.ac.nz))"
  - "Hugo J. Marrero^2^ ([hugomarrero@gmail.com](hugomarrero@gmail.com))"
  - "Jason M. Tylianakis^1^ ([jason.tylianakis@canterbury.ac.nz](jason.tylianakis@canterbury.ac.nz))"
  - "Daniel B. Stouffer^1^ ([daniel.stouffer@canterbury.ac.nz](daniel.stouffer@canterbury.ac.nz))"
bibliography: phd-bibliography/pollen-competition.bib
csl: ecology-letters.csl
output: #word_document
  bookdown::pdf_document2:
    # base_format: rticles::peerj_article
    keep_tex: yes
    number_sections: false
toc: false
fontsize: 11pt
classoption: a4paper
geometry: 
  - textwidth=33em
  - textheight=48\baselineskip
header-includes:
  - \usepackage{booktabs}
  - \usepackage{setspace}
  - \usepackage{lineno}
  - \usepackage{xr}
  - \usepackage[utf8]{inputenc}
  - \newcommand{\R}[1]{\label{#1}\linelabel{#1}}
  - \newcommand{\lr}[1]{page~\pageref{#1}, line~\lineref{#1}}
  - \externaldocument[S-]{supp-info}
  - \usepackage[export]{adjustbox}
---

\linenumbers
\doublespacing

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, 
                      warning = FALSE, dpi = 300)

loadd(abs_wordcount, msc_wordcount, n_displays, n_references)
```
 
^1^ Centre for Integrative Ecology, School of Biological Sciences, University of Canterbury, Private Bag 4800, Christchurch 8041, New Zealand

^2^ Centro de Recursos Naturales Renovables de las Zonas Semiáridas, CONICET, Camino de la Carrindanga Km. 7, 8000 Bahía Blanca, Argentina

<!-- ^a^ [efc29@uclive.ac.nz](mailto:efc29@uclive.ac.nz); ^b^ [hugomarrero@gmail.com](hugomarrero@gmail.com); ^c^ [jason.tylianakis@canterbury.ac.nz](jason.tylianakis@canterbury.ac.nz); ^d^ [daniel.stouffer@canterbury.ac.nz](daniel.stouffer@canterbury.ac.nz) -->

**Running title:** The pollination trade off

**Keywords:** X,Y,Z (up to 10).

**Type of article:** Letter.

**Number of words:** `r abs_wordcount$n_words_stri` in the abstract; `r format(round(msc_wordcount$n_words_stri), big.mark = ",")` in the main text.

**Number of displays:** `r n_displays$figures` figures; `r n_displays$tables` tables; `r n_displays$text_boxes` text boxes.

**Number of references:** `r n_references`

**Author for correspondence:** E. Fernando Cagua (+64 20 4026 8153).

**Data acessibility:** Data supporting the results will be accesible in an appropiate data repository after publication. The data DOI will be included here.

**Author contributions:** EFC wrote the manuscript and performed all analyses with input from all authors; HJM collected the data; all authors contributed to the study design. 

\clearpage

# Abstract

`r paste(drake::readd(abstract), collapse = "")`

\clearpage

# Introduction

Animal pollination systems play a disproportionally important role in food production and maintenance of global biodiversity [@bascompte_plant-animal_2007; @klein_importance_2007; @ollerton_how_2011]. 
<!-- FDO: Asked coauthors for a reference for the following statement but no-one provided. Therefore removing -->
Alongside the direct mutualisms between plants and their pollinators, biodiversity can be supported as a result of the inter-species "facilitation"—the indirect positive feedback loops that exist between plant species that share pollinators or pollinators that share plants [@moeller_facilitative_2004; @ghazoul_floral_2006; @molina-montenegro_positive_2008]. 
This inter-species facilitation is able to promote species coexistence by offsetting the effects of direct resource competition [@stachowicz_mutualism_2001]. 
Indeed, studies at the core of our current theoretical knowledge of mutualisms predict that the maximum number of coexisting species is achieved when the number of shared mutualistic partners is maximised in a community [@bastolla_architecture_2009]. 

However, in natural communities, plants rarely share all available pollinators.
One explanation is that plants are effectively competing for mutualistic partners because there is a *trade-off* between the benefits gained from maximising the number of partners and the costs of sharing them with other plant species [@waser_interspecific_1978]. 
It has been clear for a long time that when competition for pollination is strong enough, these costs can make it detrimental to plants' fitness [shown both experimentally and theoretically; @robertson_philosophy_1895; @lewis_experimental_1961; @levin_competition_1970]. 
In fact, it can be sufficient to drive ecological differentiation [for example by driving the evolution of both traits and reproductive strategies; @mitchell_new_2009; @caruso_competition_2000]. 
It is less clear, however, how exactly ecological differentiation, in turn, affect the trade-off between facilitation and competition that is involved in the pollination service.

There are two main mechanisms through which competition for pollinators can affect plant fertilization [@morales_interspecific_2008]. 
The first is intraspecific pollen transfer. 
This happens, for example, when plants with distinctively attractive flowers might reduce the number of visits to those less attractive neighbouring plants, and hence reduce the amount of *conspecific pollen* deposited by animals [@yang_pollinator_2011]. 
The second is intraspecific pollen transfer and occurs when plants share pollination partners. 
In that case, even receiving a visit might not necessarily translate into fertilization [@campbell_mechanism_1985] because a focal plant might receive *heterospecific pollen* or because pollen from the focal plant might be lost to different species. 
Generally speaking, the higher the amount of conspecific pollen (both in absolute terms and relative to heterospecific pollen) the better the pollination service received by the focal plant.
These two mechanisms of competition, by definition, occur at the community scale. 
However, with few exceptions [@rathcke_interactions_1988; @lopezaraizamikel_impact_2007; @tur_evaluating_2016; @hegland_relative_2009; @aizen_reproductive_2010], most of what we know about the deposition of conspecific and heterospecific pollen---and its relationship to competition vs. facilitation in pollination systems---is based on studies with two plant species. 

At the community scale, the factors that determine the patterns of conspecific and heterospecific pollen deposition are tightly intertwined, operate simultaneously, and may lead to emergent phenomena not observed at smaller scales [@flanagan_effects_2011]. 
For instance, recent empirical evidence suggests that plants with flowering traits that are "original" relative to others in the community generally have fewer interaction partners [@coux_linking_2016]. 
This evidence is aligned with the notion that a species which interacts with few species does so strongly with each of them whereas a species that interacts with a large number of species does so comparatively weakly (TODO: ref needed). 
If evolutionary specialisation occurs by changing traits to focus on fewer but better partners [@caruso_competition_2000], we should expect a reduction of competition for pollinators in species with "original" traits and an increase of competition in species with a large number of interaction partners [@gibson_can_2012]. 
Alternatively, it might also be the case that density (for example in terms of flower or pollen counts) is the dominant force driving pollen transfer [@seifan_outcome_2014]. 
Abundant plant species might experience a dilution of available pollinators [@feinsinger_effects_1987] but might also receive more effective visits by capitalising on a larger share of both visits and the pollen carried by pollinators. 
In this case, a potential reduction in the absolute amount of conspecific pollen received could be compensated by an increase in the amount of conspecific pollen relative to heterospecific pollen. 
Altogether, it is clear that some ecological factors can influence pollen deposition and that these factors, in the specific context of pollination, could be used to roughly define a species *realised niche* in their community. 
However, the intertwined nature of these factors makes it hard to determine whether they favour or hinder the pollination service at the community level. 
Moreover, their relative importance has not yet been empirically evaluated in natural plant communities. 

Here, we investigate competition for pollination at the community scale using empirical data from eleven plant-pollinator communities in the Argentinian Pampas. 
First, we estimate the extent to which the net outcome of plants sharing pollinators is facilitation or competition. 
If facilitation is the primary outcome, we could expect two things. 
On the one hand, we could expect an overall positive relationship between the amount of conspecific pollen deposited in stigmas and the amount of heterospecific pollen [@tur_evaluating_2016]. 
The higher the deposition of conspecific pollen relative to heterospecific, the larger the slope of that relationship.
On the other, we could also expect a larger amount of conspecific pollen deposited in stigmas when flowers are open to animal pollinators than what is deposited due to self-pollination. 
Second, we investigate the relative contribution that four ecological factors have on the pollination service. 
Specifically, we hypothesize that competition (measured as absolute and relative conspecific pollen deposition) should increase for plants that share many pollination partners.
However, we also hypothesize that other factors like the plant's functional originality, its relative abundance, and the visit effectiveness should have the potential to compensate for this increase in competition. 
Third, we examine how much does the community context influences the way plants use these factors to minimise competition. 
Although some plant species might be widespread across multiple locations, competition for pollinators occurs at the community level and hence we predict the competition for pollination niche to be influenced by the local context. 
If plant strategy is not flexible across communities (TODO: ref needed), we could expect niches to be more similar within species than across species in the study. 
On the contrary, if a species' strategy is flexible, we should expect plants to be able to occupy different niches in each community such that competition could be minimised regardless of the context. 

# Methods

We collected data from eleven co-flowering plant communities and their pollinators in three locations in the Argentinian Pampas. 
These locations are distributed across a precipitation gradient with a humid temperate climate of the eastern Flooding Pampas becoming drier as one moves inland and westward towards the Pampean Grasslands. 
This precipitation gradient generated a natural gradient of network architecture which allowed us to examine the generality of our findings. 
In each location, we sampled two restored and two agricultural fragments, except in the Flooding Pampas, where we were only able to sample one restored fragment due to the lack of available sites.

## Competition vs. facilitation

Our first objective was to identify whether the outcome of plants sharing pollinators at the community level is facilitation or competition. 
We use two complementary lines of evidence.  
The first line can be found via the relationship between heterospecific and conspecific pollen deposited in plant stigmas [@tur_evaluating_2016]. 
This is because heterospecific pollen can be seen as an unavoidable cost that plants must pay for receiving conspecific pollen from shared pollinators. 
A negative relationship (when shared pollinators increase heterospecific pollen loads and decrease conspecific loads) may indicate that competition for pollination is strong.
In contrast, a positive relationship is what would be observed when facilitation is the dominant outcome. 

The second line of evidence can be obtained by examining the difference between the amount of conspecific pollen deposited in flower stigmas *with* and *without* animal-mediated pollination. 
Self-pollination can be favourable to plant reproduction when competition for pollination is strong because it provides insurance against poor pollination service [@kalisz_benefits_2003]. 
If competition <!-- for pollination-->is sufficiently strong, then the amount of conspecific pollen deposited in flower stigmas when animal pollination is prevented should be higher than when animal pollination is allowed.
In contrast, the opposite pattern may indicate that plants benefit from having pollen delivered directly to the stigma by animals. 

### Data collection

In each of the studied communities, we quantified pollen deposition in a subset of plant species between December 2010 and February 2011. 
This subset comprised between three and nine common insect-pollinated (entomophilous) plant species that were flowering during the sampling period (see Figure \@ref(fig:fig-trade-off-predictions)a). 
We chose plant species such that they cover a wide range on a specialization-generalization gradient as well as a wide range of abundances. 
In each of the selected plants, we removed all flowers leaving only buds that were expected to go into florescence on the next day. 
Approximately a quarter of these buds were bagged to prevent animal pollination. 
Two days after inflorescence, we collected all remaining flowers' and counted the pollen grains in their pistils. 
We then classified them between conspecific and heterospecific pollen, and calculated the number of pollen grains per stigma in each flower. 
More details can be found in @marrero_agricultural_2016. 

### Data analysis

To evaluate the relationship between heterospecific and conspecific pollen, we used a generalised linear mixed model (GLMM) with a Poisson error distribution [@tur_evaluating_2016]. 
In this model, the number conspecific pollen grains per stigma was the response variable and the number of heterospecific grains the predictor (the number of stigmas sampled from the flower was added as an offset term). 
The slope and intercept of this relationship were allowed to differ between plant species within each community, which were modelled as a random effect. 
Models were fitted using the function `glmer` from the R package `lme4 1.1-19` [@bates_fitting_2015]. 
A positive slope for a plant-community combination might indicate facilitation while a negative slope might indicate competition. 

To compare the conspecific pollen deposited with and without animal-mediated pollination, we followed the same approach as above. 
In this case, however, the predictor was the treatment (whether the flower was bagged or unbagged) instead of the number of heterospecific grains. 

## Ecological constraints the pollination service 

Our second objective was to investigate the relative contribution of different factors---that describe the plant competition for pollination niche---to the pollination service. 
Generally speaking, in the context of competition for pollination we expect that a factor that increasse on the amount of conspecific pollen deposited in stigmas (both in absolute terms and relative to heterospecific pollen) also has a positive effect on the pollination service. 
Specifically, we investigated the effect of (*i*) a plant's number of shared pollinator species, (*ii*) a plants abundance relative to the rest of the community, (*iii*) the mean visit effectiveness---a metric that combines the share of pollen that a plant species is able to place on each of their floral visitors and the number of visits it receives from them, and (*iv*) the plants functional originality [@laliberte_distance-based_2010]. 
See *Data Analysis* section below for more details on these four variables. 
<!-- Here, we define visit effectiveness of the pollinator species *i* to plant species *j* as the proportion between the visits of *i* to *j* and all visits of *i*, multiplied by the proportion between the number of pollen grains of *j* attached to individuals of *i* and all pollen attached to individuals of *i*. -->

### Data collection

To obtain the number of shared pollinators for each species, we collected data to construct qualitative and quantitative pollination networks. 
Qualitative networks were constructed based on two-hour observations of floral visits in each fragment. 
Quantitative networks were constructed using two 50 m randomly located transects in each fragment. 
We counted and collected all floral visitors found in a 2 m wide strip while walking at a pace of 10 m per minute [@marrero_effect_2014; @memmott_structure_1999]. 
We visited the transects each month between November 2010 and March 2011. 
To obtain plant abundance, we counted all units of floral attraction found during an independent sampling of the transects used to construct the quantitative visitation networks. 
To estimate visit effectiveness we need to construct pollen transfer networks in addition to the visitation networks. 
To construct the transfer networks, we examined the pollen loads present on the floral visitors collected [@marrero_exotic_2017]. 
When the pollen count on an individual animal was estimated to be less than 2,000 grains, we identified every grain to the species level when possible and to pollen complexes when it was not. 
When the pollen count was above 2,000 grains, we classified approx. 50% of pollen and total pollen counts were extrapolated [@bosch_plant-pollinator_2009]. 
Finally, we also recorded morphological traits that relate to plant type (herb, shrub, climber), life cycle (annual, perennial), flower colouration, phenology, and whether the species is native in the study region. 
We used those traits because they were the only ones available. <!--.. (TODO: Add a better justification for the traits used)-->
More details can be found in Marrero *et al.* (2014 and 2017).

### Data analysis

To investigate the impact of ecological factors on pollination service we used two sets of linear mixed models (LMM) with boothstrap resampling.
The response variables for these model sets were the number of conspecific and heterospecific pollen grains deposited per stigma in flowers open to animal-mediated pollination. 
We used LMMs in which pollen loads were log-transformed (Figure \@ref(S-fig:fig-deposition-gain-log-transformed-or-not)) because these models offered a better fit than a GLMM with Poisson (or quasipoisson) error structure. 
Models were fitted using the R package `nlme 3.1-131` [@pinheiro_nlme_2018]. 

Because the amount of deposited pollen can vary widely across species, and potentially also across communities, we evaluated two possible structures for the random effects: one that includes a random intercept for plant species, and one that treats measures from species across different communities as independent. 
We selected the best random structure by comparing the median Akaike Information Criterion for small samples (AICc). 

As predictors in the models, we included the four ecological variables described above. 
Specifically, we calculated the number of shared pollinators for each plant species by pooling data from the qualitative and quantitative pollination networks. 
<!-- This variable is strongly correlated to the number of animal species a plant interacts with (the species degree).  -->
To calculate the plants' relative abundance in their community, we simply aggregated floral counts for each species. 
We then calculated the mean visit effectiveness. 
We define the effectiveness of a visit by pollinator species *i* to plant species *j* as \[e_{ij} = \frac{v_{ij}}{v_i} \frac{p_{ji}}{p_j}\] where *v~ij~* is the observed number of visits by *i* to *j*, *p~ji~* is the number of pollen grains from *j* attached to *i*, *v~i~* is the total number of visits performed by *i*, and *p~j~* is the total number of grains carried by *j*.
Because the number of shared pollinators, floral abundance, visitation, and pollen production roughly followed a power-law distribution, we log-transformed these three predictors before including them in the model. 

Finally, functional originality is defined as the distance of a species from the community trait average--the centroid of functional space of the community [@laliberte_distance-based_2010; @coux_linking_2016]. 
<!-- As phenology has been shown to be a key mechanism of niche differentiation among plants, we also  -->
To include phenology, we treated plant abundance in each of the survey months (November to March) as a "trait" in our analysis. 
<!-- This approach allowed us to integrate the originality in phenological niche alongside the originality on other functional traits.  -->
To account for the non-independence of floral counts and weight all traits equally, we assigned the abundances a weight of 1/5 (one for each month) compared to other functional traits. 
We scaled all traits prior to calculating the centroid of the functional space and calculated the species-specific functional coordinates using the R package `FD 1.0-12` [@laliberte_fd_2014]. 
Finally, to facilitate comparison across the four continuous explanatory variables in our models, we rescaled them all to have a zero mean and unitary variance.

To estimate the coefficients and to perform model selection and quantify the associated uncertainty, we used a combination of multi-model inference and bootstrap resampling with one hundred replicates. 
First, we performed model selection using the AICc and determined the likelihood of each candidate model (a particular combination of predicting variables) by calculating the median \(\Delta\)AICc (relative to the most likely model) for each bootstrap sample. 
As we wanted model coefficients from more likely candidate models to carry more weight in our results, we sampled the coefficients for our variables proportional to the likelihood of its candidate model. 
<!-- We "shrank" the estimated coefficient of potentially unimportant variables by setting their estimate to 0 when the variable was not included in the model.  -->
Finally, we used these distributions of the model coefficients to estimate their mean impact on the pollination service (in terms of absolute and relative conspecific pollen deposition). 
<!-- Again, here we used bootstrap resampling to estimate the uncertainty around these means.  -->

## Flexibility of plant strategies

Our last objective was to tease apart the plant strategies that might reduce competition and, importantly, how the community context influences these strategies. 
If community context plays a relatively small role or the species strategy is inflexible we would expect plants of the same species to fill similar competition for pollination niches across different communities. 
Alternatively, if the community plays a large role and plants strategies are flexible, we should be able to observe differences in the niche a plant species occupies across communities. 
First, we used a principal component analysis (PCA) of the four ecological variables. 
We scaled variables across the whole study to ensure that the PCA space does not change according to the species present in each community. 
We define a species' niche in a community as its coordinates in PCA space. 
For each species that was present in two or more communities, we then calculated (*i*) the median distance between the strategies that the species uses in different communities and (*ii*) the area of the convex hull defined by these points in the first two principal components (only for species present in three or more communities). 
We then compared the magnitude of these two metrics to those obtained with 99 Monte Carlo randomizations in which we replaced the strategy of the focal plant species by that of another randomly selected species in the dataset. 

# Results

## Competition vs. facilitation

```{r facilitation-random-model-stats, echo = F}
drake::loadd(facilitation_plot_df)

# count number of species with positive and negative slopes
counts_facilitation_slope <- facilitation_plot_df %>%
  dplyr::group_by(effect_category) %>%
  dplyr::count() %>%
  dplyr::group_by() %>%
  dplyr::mutate(np = nn/sum(nn), 
                np = round_preserve_sum(np, 2)*100)

# species with both positive and negative relationships
get_sp_with_both_pos_neg <- . %>%
  dplyr::filter(effect_category != "neutral") %>%
  dplyr::group_by(plant_name) %>%
  dplyr::summarise(both = dplyr::n_distinct(effect_category) > 1) %>%
  dplyr::filter(both)

# Get list of species with both positive and negative slopes
sp_both_pos_neg <- facilitation_plot_df %>%
  get_sp_with_both_pos_neg() %>%
  dplyr::mutate(plant_name = as.character(plant_name)) %>%
  dplyr::arrange(plant_name) %>%
  dplyr::mutate(plant_name = stringr::str_extract(plant_name,
                                                  "[A-Z]\\w+\\s[a-z]\\w+"), 
                plant_label = paste0("*", plant_name, "*")) 
# Human readable list of species with both positive and negative slopes
sp_both_pos_neg_names <- sp_both_pos_neg %$%
  glue::collapse(plant_label, sep = ", ", last = ", and ")

# equal number of negative and positive?
equal_pos_neg <- counts_facilitation_slope$nn[1] == counts_facilitation_slope$nn[3]
```

We first examined the degree of facilitation/competition in natural communities. Specifically, we examined the slope of the relationship between the heterospecific and conspecific pollen deposited on stigmas of each species in a community. 
We found that overall neither facilitation nor competition dominates (Table \@ref(S-tab:table-facilitation-models-general)). 
Indeed, we found that the proportion of species that experienced a statistically significant positive or negative relationship between heterospecific and conspecific pollen than negative was very similar (`r counts_facilitation_slope$np[3]`% and `r counts_facilitation_slope$np[1]`%, respectively; Figure \@ref(fig:fig-trade-off-predictions)a; Table \@ref(S-tab:table-facilitation-models-random)). 
Most of the variation between plants in a facilitation-competition gradient was driven by differences *between* species; however, we also observed some important differences *within* species. 
For instance, `r numbers2words(nrow(sp_both_pos_neg))` of the species sampled across multiple communities (`r sp_both_pos_neg_names`) showed evidence that the same species, can experience facilitation (positive relationships) in some communities and competition (negative relationships) in others. 
Interestingly, although there was a wide variation in the slope of the relationship between heterospecific and conspecific pollen almost all plants had more conspecific than heterospecific pollen deposited on their stigmas (Figure \@ref(fig:fig-trade-off-predictions)b). 

```{r fig-trade-off-predictions, fig.height= 4, out.height="4in", fig.width = 7.49, out.width="7.49in", out.extra="center", fig.cap = "Competition vs. facilitation at the community level. (a) Some species experience more competition for pollination than others. Points indicate the estimated slopes for the relationship between the amount of heterospecific and conspecific pollen deposited per stigma across species in their communities. Statistically significant negative slopes (darkest shade) indicate that plants experience competition for animal-mediated pollination, while significantly positive slopes (lightest shade) indicate that facilitation is the predominant outcome. The number of plants analysed for each species is shown within brackets next to the species name. (b) Despite the variety of slopes, overall plants had more conspecific than heterospecific pollen deposited in their stigmas. (c) Generally, plants also had more pollen deposited in their stigmas when they were open to animal-mediated pollination than when they were closed. In all plots, error bars correspond to $\\pm$ the standard error (SE)."}
# fig_random_slopes <- plot_random_slopes(facilitation_plot_df)
# fig_hetero_con <- make_fig_con_hetero_empirical(dep_frame)
# fig_con_con = plot_bagged_vs_open_conspecific(drake::readd(con_con_plot_df))
# pdf(width = 6.5, height = 4)
drake::loadd(fig_random_slopes)
drake::loadd(fig_con_con)
drake::loadd(fig_hetero_con)
width_left <- 6.5*3/5
bar_plot_width <- 0.29
rw <- c(width_left - bar_plot_width,
        bar_plot_width, 
        6.5 - width_left - bar_plot_width,
        bar_plot_width)
left <- cowplot::plot_grid(
  fig_hetero_con,
  NULL,
  fig_con_con[[1]],
  fig_con_con[[2]],
  ncol = 2, 
  rel_widths = rw[c(3,4)], 
  align = "h"
)
right <- cowplot::plot_grid(
  fig_random_slopes[[1]],
  fig_random_slopes[[2]], 
  # ncol = 2, 
  align = "h", 
  rel_widths = rw[1:2]
)
cowplot::plot_grid(
  right,
  left,
  ncol = 2,
  rel_widths = c(sum(rw[1:2]), sum(rw[3:4]))
)
# dev.off()
```

```{r facilitation-conspecific-stats}
drake::loadd(con_con_plot_df)
# overall counts of possitive/negative
sp_con_con <- con_con_plot_df %>%
  dplyr::group_by(effect_category) %>%
  dplyr::count() %>%
  dplyr::group_by() %>%
  dplyr::mutate(np = n/sum(n), 
                np = round_preserve_sum(np, 2)*100)
# species with contrasting behaviours
sp_con_both_pos_neg <- con_con_plot_df %>%
  get_sp_with_both_pos_neg() %>%
  dplyr::arrange(plant_name) %>%
  dplyr::mutate(plant_label = dplyr::if_else(plant_name %in% sp_both_pos_neg$plant_name, shorten_sp_name(plant_name), plant_name),
                plant_label = paste0("*", plant_label, "*"))
```

Second, we compared the amount of conspecific pollen deposited on flowers that were open to animal-mediated pollinators with that of those that were closed. 
Here, we again found large differences between plants but with a clear tendency to find more pollen in open flowers (Table \@ref(S-tab:table-open-bagged-models-general)). 
Specifically, `r sp_con_con$np[sp_con_con$effect_category == "positive"]`% of plants had more pollen when open and `r sp_con_con$np[sp_con_con$effect_category == "negative"]`% had less pollen when open (the difference was statistically non-signifcant for the remainding `r sp_con_con$np[sp_con_con$effect_category == "neutral"]`%; Figure \@ref(fig:fig-trade-off-predictions)c; Table \@ref(S-tab:table-open-bagged-models-random)). 
Variation within species was slightly smaller and only `r numbers2words(nrow(sp_con_both_pos_neg))` species (`r glue::collapse(sp_con_both_pos_neg$plant_label, sep = ", ", last = ", and ")`) had both positive and negative differences. 

## Ecological constraints in the pollination service 

```{r model-fit-statistics}
drake::loadd(r2_values)
```

We then examined the potential roles played by four ecological variables (number of shared pollinators, plant abundance, mean visit effectiveness, and functional originality) play in pollen deposition. 
<!-- Together these variables can describe the niche that plants might occupy in the context of competition for pollination.  -->
We found that our models of pollen deposition had high explanatory power (the coefficient of determination R^2^ ranged between `r min(r2_values$r2c_min)` and `r max(r2_values$r2c_max)`) although a large portion of the explanatory power came from the random effects (Table \@ref(S-tab:table-R2)).
As determined by AICc, the random structure best supported by the data was the one that fit an intercept for each species in each community (as opposed to a common intercept for each species irrespective of the community they belong to). 
This structure was best for both the models of conspecific and heterospecific pollen (Table \@ref(S-tab:table-aic-random-models)).  

Of the four variables, we considered, we found that a plant's mean visit effectiveness and abundance were the most important ecological variables predicting pollen deposition in plant stigmas (Figure \@ref(fig:fig-average-qual-quant)a). 
Surprisingly, the number of shared pollinators was comparatively unimportant, particularly for models of heterospecific pollen deposition, as it was only ever included in models with relatively large AICc values (Table \@ref(S-tab:table-aic-fixed-models)). 

We found that the relationship between each of the ecological factors and pollen deposition was similar for both conspecific and heterospecific pollen. 
That is, strategies that were associated with an increase in conspecific pollen were also associated with an increase in heterospecific pollen deposition. 
Specifically, the plants' mean visit effectiveness had a positive effect on pollen deposition (Figure \@ref(fig:fig-average-qual-quant)b). 
However, the effect size was slightly larger for heterospecific than for conspecific pollen. 
This indicates that, although there is a positive association between visit effectiveness and the *absolute* amount of conspecific pollen, there is a negative relationship with the *relative* amount of conspecific relative to heterospecific pollen (Figure \@ref(fig:fig-average-qual-quant)c). 
In contrast, a plants' relative abundance had a negative effect on the absolute amount of conspecific pollen, but the mean difference between the coefficients in the models indicates a positive association with the relative amount of conspecific pollen (Figure \@ref(fig:fig-average-qual-quant)c). 
The third most important variable, functional originality, had a positive, although comparatively smaller, association with both the absolute and relative amount of conspecific pollen deposited. 
Finally, the number of shared pollinators had a negative and neutral association with conspecific and heterospecific pollen, but these impacts were small when compared to the other variables. 

Overall, collinearity did not affect our findings qualitatively.
Although relative abundance, the number of shared pollinators, and the visit effectiveness were all positively correlated (Figure \@ref(S-fig:fig-correlation)), the effect each had on conspecific pollen was similar among models that included all or just some of these three explanatory variables (Figure \@ref(S-fig:fig-model-results)). 
One exception was visit-effectiveness, which exhibits a positive association with the relative amount of conspecific pollen under some variable combinations (all with relatively low AICc support).

```{r fig-average-qual-quant, fig.height= 2.28*2, fig.width=width('single'), out.height="4.56in", out.width="3.57in", out.extra="center", fig.cap="Effect of strategies to minimise competition in the pollination service. (a) The plant's visit effectiveness and relative abundance are the most important variables determining the deposition of conspecific and heterospecific pollen. Meanwhile, the number of shared pollinators was relatively unimportant. The graph shows the relative variable importance calculated as the sum of the Akaike weights of the candidate models that included the variable. (b) The association between ecological variables and heterospecific pollen tended to align with their association with conspecific pollen. Visit effectiveness and functional originality had a positive association with pollen deposition, while abundance and the number of shared pollinators had a negative association. The plot shows the distribution of the effects (across 99 bootstrap replicates) of the four ecological variables for conspecific and heterospecific pollen. (c) The end result of these associations is that only the plants' functional originality has a positive impact on both the absolute and relative amount of conspecific pollen deposition (relative to heterospecific pollen). The plot shows the model averaged mean effect ($\\pm$ SE of 99 bootstrap replicates)."}
height1 <- 1
height2 <- 1.28
# pdf(width = 3.25 , height = sum(c(height1, height2))*2)
# fig_coef_avg <- plot_coefficient_averages(coefficient_averages, variable_importance)
# width_imps <- 6.5/5*2
# mult <- 2.455 # for 2/3 is xx, for 3/5 is 2.355
# width_coef_1 <- (6.5 - width_imp) / (1 + mult)
# width_coef_2 <- 5.6 - width_imp - width_coef_1
# fig_var_importance <- plot_variable_importance(variable_importance)
drake::loadd(fig_var_importance)
drake::loadd(fig_coef_avg)
drake::loadd(fig_coefficient_averages)

var_impo <- cowplot::plot_grid(
  fig_var_importance[[1]],
  fig_var_importance[[3]],
  fig_var_importance[[2]],
  ncol = 3,
  rel_widths = c(1,0.75,1),
  align = "h"
)

bottom <- cowplot::plot_grid(
  fig_coef_avg[[1]],
  fig_coef_avg[[3]],
  fig_coef_avg[[2]],
  rel_widths = c(1,0.75,1), 
  ncol = 3,
  align = "h"
)

cowplot::plot_grid(
  var_impo, 
  fig_coefficient_averages,
  bottom, 
  ncol = 1, 
  rel_heights = c(height1, height1 + height2, height2)
)

# dev.off()
```

## Flexibility of plant strategies

```{r pca-stats}
drake::loadd(pcas)
drake::loadd(permanova_plant_distances)
chosen_threshold <- 0
this_pca <- pcas %>%
    purrr::keep(~ .$call$X$pca_type[1] == "across") %>%
    purrr::keep(~ .$call$X$threshold[1] == chosen_threshold) %>%
    extract2(1)
median_distances <- permanova_plant_distances %>% 
  dplyr::filter(na_threshold == 0, metric == "median_dist", !is.na(value)) %$%
  value
```

```{r fig-pca, fig.width=3.57, fig.height=6.65, out.width="3.57in", out.height="6.65in",  out.extra="center", fig.cap="**The flexibility of plant strategies**. (a) The two first components explain a large proportion of the total variance. (b) When plants that were sampled in more than one community are plotted with these two components, we observe that points, which represent the strategy (the particular combination of ecological variables) of a species in a community do not seem to be grouped by plant species. (c) This was confirmed using Monte Carlo randomizations of the median distance between strategies of a plant species. Only one of the examined species had strategies that were more tightly connected than what would be expected at random."}
height0 <- 1.55
height1 <- 2.7
height2 <- 2.4
strategy_fig_height <- sum(height0, height1, height2)
# fig_pca <- plot_pca(pcas, chosen_threshold = 0)
# fig_distances <- plot_permanova_dist(permanova_plant_distances, permanova_site_distances)
# fig_pca_contrib <- plot_pca_variances_and_contributions(pcas, chosen_threshold = 0)
# pdf(width = 3.25, height = strategy_fig_height)
drake::loadd(fig_pca_contrib)
drake::loadd(fig_pca)
drake::loadd(fig_distances)
cowplot::plot_grid(
  fig_pca_contrib,
  fig_pca,
  fig_distances,
  ncol = 1, 
  rel_heights = c(height0, height1, height2), 
  align = "v"
)
# dev.off()
```

We used a PCA of the analysed species to investigate whether plants' niche of competition for pollination is similar across communities or whether they are flexible, and therefore a reflection of the community context. 
The first two PCA components explained `r round(this_pca$eig[2, 3])`% of the total variance (Figure \@ref(fig:fig-pca)a). 
The first component was dominated by changes in visit effectiveness and relative abundance while the second component was dominated by the number of shared pollinators and the plant's functional originality. 
When we locate the species that were sampled in more than one community in the first two PCA components (Figure \@ref(fig:fig-pca)b), we observe that the niches of any given species do not tend to be close to each other. 
Indeed, when we measured the median distance between the plants coordinates, we found that it was only significantly smaller than that of randomisations for only `r numbers2words(sum(median_distances < 0.05))` of the `r numbers2words(length(median_distances))` analysed species (Figure \@ref(fig:fig-pca)c). 

# Discussion 

Our results suggest that community context plays a central role in determining net cost or benefit of sharing pollinators.
First, we found that pollinatior sharing can lead to both overall facilitative and competitive effects to plant species in a community. 
Second, we found that multiple ecological factors can modulate the intensity of competition; however, conspecific and heterospecific pollen deposition are tightly coupled and therefore there is a clear trade-off between the quantity and purity of pollination [@thomson_effects_2019]. 
Third, we found that the way these factors influence competition is strongly shaped by the community context, this is, if collectively these factors are used to define a niche of competition for pollination, the same plant species can occupy dramatically different niches depending on the community it belongs to. 

Both of the criteria we used to identify the effect of animal-mediated pollination suggested the same outcome: that neither facilitation or competition are dominant in pollination communities.
A previous study showed that in diverse pollination communities, sharing pollinators does not necessarily translate to net competition [@tur_evaluating_2016]. 
The overall extent of facilitation/competition of pollination communities can depend on factors like the adversity of the environment [@tur_evaluating_2016; @callaway_positive_2002] or how disturbances affect pollinator populations [@stavert_exotic_2017]
However, why some species experience more competition than others was not understood. 
Here we show that the coexistence of facilitative and competitive effects of animal-mediated pollination can be at least partially explained by the trade-offs plants have to undergo when maximising the deposition of conspecific pollen and simultaneously minimising that of heterospecific pollen both in the short and the long term.   

In the short term, being a specialist and sharing no pollinators might reduce competition [@muchhala_competition_2010] and hence be preferable, as we show that sharing pollinators reduces both the quantity and purity of the conspecific pollen deposited. 
However, over long periods of time, there could be a risk associated with a specialist plant having no pollinators. 
Hence, is likely that to ensure long term survival, plants also need to balance this risk with the costs of sharing pollinators. 
One possible solution is to share pollinators *and* have original traits---as we show that trait originality is generally beneficial to pollen deposition and it’s commonly thought that species that are further from others in trait space benefit from reduced competition. 
Yet, there are two possible caveats to this strategy that highlight the interrelatedness of the ecological factors. 
First, in a mutualism context, it is also possible that trait originality could come at the cost of being less ‘apparent’ to pollinators [@reverte_pollinators_2016]. 
Second, the negative, relationship between originality and generalism  [@carvalheiro_potential_2014] has been shown depend on the plant's abundance [@coux_linking_2016], with generalist species being able to also have original traits only when they are abundant enough to provide a valuable reward to make it worth to pollinators. 
Visit effectiveness (high pollen and visits) and abundance, which were the most important predictors of pollen deposition, involved an even more explicit trade-off between gaining  conspecific pollen and avoiding heterospecific pollen. 
On the one hand, receiving high visitation increases conspecific pollen deposition but increases heterospecific pollen to a greater extent---even when the visitors are likely to carry a high proportion of conspecific pollen [@fang_paradoxical_2016]. 
On the other, being abundant reduces the amount of heterospecific pollen deposited but this comes at the expense of a noticeable reduction in the amount of conspecific pollen. 
Our results corroborate the importance that two-species studies have ascribed to visitation and abundance [@feldman_when_2004; @munoz_presence_2008; @morales_interspecific_2008]. 
But importantly, they also suggest that [because visitation, pollen production and abundance are usually correlated; @sargent_role_2006] balancing the pros and cons of sharing pollinators at the community level is not trivial and might even be partially responsible for the diversity of plant-pollinator communities [@benadi_frequency_2018].

We observed, as expected, that the effects of pollen deposition can vary widely among species. 
For instance, while the fitness of some plant species can be hurt even by low amounts of heterospecific pollen, for others species, fitness can instead be limited by the amount of conspecific pollen [@campbell_mechanism_1985; @arceo-gomez_interactive_2019]. 
Alternatively, plant species can also differ substantially on the extent to which self- vs. outcross-pollen differ in their value for fertilization. 
The difference can be particularly relevant for species that are not self-fertile or those in which self-fertilization is rarely effective due to a temporary separation in the maturation of the sexes (dichogamy). 

Importantly, here we show that the balances between cost and benefits are determined not only by species identity but also on the community plants belong to. 
Specifically, most plant species appear to be flexible enough to adopt markedly different niches in different communities. 
Although there are many exceptions, some plant families (Asteraceae for example) are often generalists in their communities while others (Orchidaceae) are known to be more commonly specialised [@johnson_generalization_2000]. 
From an evolutionary perspective, our results suggest that that selection for a particular strategy might say something about the community in which a species has typically inhabited during its evolutionary history. 
Furthermore, from a more applied perspective, flowering plants are sometimes introduced to attract pollinators on other nearby plants. 
On the one hand, our results suggest that introduced plants that increasse the relative originality of natives (e.g. through distinct phenology) might have positive effects [@gibson_can_2012]. 
On the other, because different niches can lead to different outcomes across communities, our results also highlight the difficulties involved in predicting whether the introduced plant species will facilitate or compete with neighbours [@bartomeus_contrasting_2008]. 
Other factors that we were unable to measure (e.g. pollinator behaviour and densities or the spatial context) have also be shown to play a role in the outcome of animal-mediated pollination [@ye_competition_2014; @flanagan_effects_2011; @cariveau_spatially_2009; @thomson_effects_2019].
Nevertheless our results indicate that the strategies plant might use to minimise competition for pollination must be relative to other species in the community, rather than an absolute property of the species. 

Overall, pollination communities might not necessarily be the paradigmatic mutualistic communities we often believe. 
Instead, we confirm that plant competition is pervasive in pollination communities. 
The potential strategies to minimise competition are likely to involve strong trade-offs in the pollination service both in the short and long-term. 
<!-- Specifically, although not sharing pollinators and being functionally unique reduces competition for pollination by increasing the quantity and purity of conspecific pollen deposition.  --> 
<!-- Remarkably, this increase is surprisingly small when compared to the effect of relative abundance and visitation.  -->
<!-- Interestingly, these two factors also involve the largest trade-offs between increasing deposition of conspecific pollen and reducing that of heterospecific pollen.  -->
Most remarkably, despite large differences on the quantity and purity of conspecific pollen deposition among species, our results provide solid evidence that competition for pollination is inherently a community process and the same species can occupy different niches in different communities. 
<!-- Overall, species coexistence is not solely determined by direct and indirect mutualistic relationships, but also strongly shaped by the multiple intertwined ecological factors that shape competition for pollination at the community level.  -->
Many of the widely used theoretical models of plant-pollinator communities do not account for the negative effects of sharing pollinators [but see @rohr_structural_2014 and similars]. 
However, achieving a better understanding of species coexistence and how plant biodiversity is supported by pollination communities will require seeing them as both mutualistic and competitive communities [@johnson_coexistence_2019]. 

# Acknowledgements

`r paste(drake::readd(acknowledgements), collapse = "")`

# References
