---
title: "The pollination trade-off"
author: "Fernando Cagua^1^, Hugo J. Marrero^2^, Jason M. Tylianakis^1^, Daniel B. Stouffer^1^"
bibliography: phd-bibliography/pollen-competition.bib
csl: ecology-letters.csl
output:
  bookdown::pdf_document2:
    # base_format: rticles::peerj_article
    keep_tex: yes
    number_sections: false
toc: false
header-includes:
  - \usepackage{booktabs}
  - \usepackage{setspace}
  - \usepackage{lineno}
  - \usepackage{xr}
  - \usepackage[utf8]{inputenc}
  - \newcommand{\R}[1]{\label{#1}\linelabel{#1}}
  - \newcommand{\lr}[1]{page~\pageref{#1}, line~\lineref{#1}}
  - \externaldocument[S-]{supp-info}
---

\linenumbers
\doublespacing
 
^1^ Centre for Integrative Ecology, School of Biological Sciences, University of Canterbury, Private Bag 4800, Christchurch 8041, New Zealand

^2^ Centro de Recursos Naturales Renovables de las Zonas Semiáridas, CONICET, Camino de la Carrindanga Km. 7, 8000 Bahía Blanca, Argentina

**Author for correspondence:** E. Fernando Cagua (efc29@uclive.ac.nz) - Centre for Integrative Ecology, School of Biological Sciences, University of Canterbury, Private Bag 4800, Christchurch 8140, New Zealand

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, 
                      warning = FALSE)
```

```{r draft-details}
drake::loadd(msc_wordcount, abs_wordcount)
```

**Manuscript length:** `r format(msc_wordcount$n_char_tot_stri, big.mark = ",")` characters, approx. `r format(round(msc_wordcount$n_words_stri/10)*10, big.mark = ",")` words (excludes front-matter, abstract, awknoledgements, references, and figure/table legends); `r msc_wordcount$reading_time_stri` min. reading time.

**Abstract length:** `r abs_wordcount$n_words_stri` words.

\clearpage

# Draft Info

## Changes

* Now using `docker` to manage project dependencies. Image is now available on dockerhub efcaguab/pollen-competition.
* Removing *quantity* and *quality* of pollination in favour of the plain metrics of *conspecific* and *heterospecific* pollen deposition. 
* Rewording the plant strategies idea as it was confussing. Now the combination of ecological variables (number shared pol., abundance, visitation patterns, and traits) define a species *realised niche* (this was previoulsy called the plant strategy). Plants that can have very different realised niches across different communities have a *flexible strategy* (this was previously called strategy as well).
* Manuscript formatted for submission to Ecology Letters.
* Sticking to past tense throughout the methods.
* GLMM to fit slope of heterospecific-conspecific pollen relationship tests all communities at once (it was a model per community). Response variable is the number of grains (it was number of grains per stigma) and the (log) number of stigmas in the flowers has been included as an offset term.
* Using a similar approach to compare conspecific pollen deposited in open and bagged flowers (I used a series of Mann-Withney U tests before)
* Added model results tables in the Supplementary Information

## Todo

* Polish discussion, will appreciate input here. 
* Polish supp. info.
* Spell-check everything & check that reference list is correct.
* I think its not supper clear in the manuscript what is meant by a plant strategy. Need to re-check in the next iteration. 

## Questions

Feel free to come back here after you've read the manuscript. Thanks!

* Minor point: DBS thinks that normally one would use the technical word and then put the definition in parenthesis. In a previous revision I got from JMT that it's better to lead with the concept and then add the jargon last. Examples: *"...due to a temporary separation in the maturation of sexes (dichogamy)"*, *"...common insect-pollinated (entomophilous) species"*.

* Journal? --- *Hugo says PNAS, Proceedings B and Science. No answer from other coauthors*
* I think the story is still a bit disperse. Will appreciate feedback on identifying the most important/exciting findings to tie the others around it. So far the central topic is scaling up of competition to the community level. --- *No particular feedback received*
* Do you know of a reasonable reference for the claims in \lr{ref-needed-possitive-loops} and \lr{ref2}? --- *No particicular feedback received*
* Hugo. Some journals require publication of data alongside with the paper. Is it OK to consider those? Or you prefer to keep data private? --- *It is OK*
* In Figure \@ref(fig:fig-trade-off-predictions)a, I determine if the slope is significantly positive or negative by checking whether the standard errors cross 0. Should it be 2 times SE? Should all other error bars in Figure \@ref(fig:fig-trade-off-predictions) be 2 times SE? --- *No particular feedback received*
* What do you think about the quantity/quality discourse now? I'm still unconvinced. Maybe I should just go for relationship conspecific/heterospecific instead of quality? That would mean that Figure \@ref(fig:fig-average-qual-quant)c would just need the right panel. Cause the left is just almost the same as Figure \@ref(fig:fig-average-qual-quant)b, except that it includes models in which the variable was not present and hence "shrinks" the model averaged estimate. --- *Daniel advocates for getting rid of quantity/quality and go for conspecific/conspecific proportion*
* Unsure of whether in Figure \@ref(fig:fig-pca)a, it would be better to display the contribution of each component to total variance instead of the cummulative contribution. --- *Add info to left of the figure*
* I'm not very happy with the way the third hypothesis is described in the intro (\lr{third-hypothesis}). I would appreciate ideas to rephrase it clearly
* Does the paragraph in \lr{disc-facil-comp} needs more meat? Any suggestions?
* My background in the topic is limited, would be grateful if you could point me out to key papers that could be used to put some context to the finding of the "flexibility" of plants strategies (paragraph in \lr{strategies}) --- *DBS argues that I say that strategies minimise competition but I never show that, only show that strategies change. Need to think about that*
* Part of the discussion before revolved about the fact that degree is commonly used in theoretical models of mutualism to adjust the mutualistic benefit of generalist species. I've removed it because I think the discussion is already a bit long and didn't fit that nicely in the story. You think it should be included? --- *DBS says is OK to leave it out*

\clearpage

# Abstract

`r paste(drake::readd(abstract), collapse = "")`

**Keywords:** X, Y, Z 

\clearpage

# Introduction

Animal pollination systems play a disproportionally important role in food production and maintenance of global biodiversity [@bascompte_plant-animal_2007; @klein_importance_2007; @ollerton_how_2011]. 
<!-- FDO: Asked coauthors for a reference for the following statement but no-one provided. Therefore removing -->
Alongside the direct mutualisms between plants and their pollinators, biodiversity can be supported as a result of inter-species "facilitation"—the positive feedback loops that exist between plant species that share pollinators or pollinators that share plants [@moeller_facilitative_2004; @ghazoul_floral_2006; @molina-montenegro_positive_2008]. 
This inter-species facilitation is able to promote species coexistence by offsetting the effects of direct resource competition [@stachowicz_mutualism_2001]. 
Indeed, studies at the core of our current theoretical knowledge of mutualisms predict that the maximum number of coexisting species is achieved when the number of shared mutualistic partners is maximised in a community [@bastolla_architecture_2009]. 

However, in natural communities, plants rarely share all available pollinators.
One explanation is that plants are effectively competing for mutualistic partners because there is a *trade-off* between the benefits gained from maximising the number of mutualistic partners and the costs of sharing them with other plant species [@waser_interspecific_1978]. 
It has been clear for a long time [both experimentally and theoretically; @robertson_philosophy_1895; @lewis_experimental_1961; @levin_competition_1970] that when competition for pollination is strong enough, it can be detrimental to plants' fitness. 
In fact, it can be sufficient to drive ecological differentiation [for example by driving the evolution of of both traits and reproductive strategies; @mitchell_new_2009; @caruso_competition_2000]. 
It is less clear, however, how exactly ecological differentiation, in turn, affect the trade-off between facilitation and competition that is involved in the pollination service.

There are two main mechanisms through which competition for pollinators can affect plant fertilization [@morales_interspecific_2008]. 
The first is intraspecific pollen transfer. 
This happens, for example, when plants with distinctively attractive flowers might reduce the number of visits---and hence the amount of *conspecific pollen* deposited by animals---to those less attractive neighbouring plants [@yang_pollinator_2011]. 
The second is intraspecific pollen transfer and occurs when plants share pollination partners. 
In that case, even receiving a visit might not necessarly translate into fertilization [@campbell_mechanism_1985] because a focal plant might receive *heterospecific pollen* or pollen from the focal plant might be lost to different species. 
Generally speaking, the higher the amount of conspecific pollen (both in absulute terms and relative to heterospecific pollen) the better the pollination service received by the focal plant.
These two mechanisms of competition, by definition, occur at the community scale. 
However, with few exceptions [@rathcke_interactions_1988; @lopezaraizamikel_impact_2007; @tur_evaluating_2016; @hegland_relative_2009; @aizen_reproductive_2010], most of what we know about the deposition of conspecific and heterospecific pollen---and its relationship to competition vs. facilitation in pollination systems---is based on studies of two plant species. 

At the community scale the factors that determine the patterns of conspecific and heterospecific pollen deposition are tightly intertwined, operate simultaneously, and may lead to emergent phenomena not observed at smaller scales [@flanagan_effects_2011]. 
For instance, recent empirical evidence suggests that plants with flowering traits that are "original" relative to others in the community generally have fewer interaction partners [@coux_linking_2016]. 
This evidence is aligned with the notion that a species that interacts with few species does so strongly with each of them whereas a species that interacts with a large number of species does so comparatively weakly (TODO: ref needed). 
If evolutionary specialisation occurs by changing traits to focus on fewer but better partners [@caruso_competition_2000], we should expect a reduction of competition for pollinators in species with "original" traits and an increase in species with a large number of interaction partners [@gibson_can_2012]. 
Alternatively, it might also be the case that density (for example in terms of flower or pollen counts) is the dominant force driving pollen transfer [@seifan_outcome_2014]. 
Abundant plant species might experience a dilution of available pollinators [@feinsinger_effects_1987] but might also receive more effective visits by capitalising on a larger share of both visits and pollinator "real state". 
In this case, a potential reduction the absolute amount of conspecific pollen received could be compensated by an increase amount relative to heterospecific pollen. 
Altogether, it is clear that some ecological factors can influence pollen deposition and that these factors, in the specific context of pollination, could be used to roughly define a species *realised niche* in their community. 
However, the intertwined nature of these factors makes it hard to determine wether they favour or hinder the pollination service at the community level. 
Moreover, their relative importance has not yet been empirically evaluated in natural plant communities. 

Here, we investigate competition for pollination at the community scale using empirical data from eleven plant-pollinator communities in the Argentinian Pampas. 
**First**, we estimate the extent to which the net outcome of plants sharing polinators is facilitation or competition. 
If facilitation is the primary outcome, we could expect two tings. 
On the one hand, we could expect an overall positive relationship between the amount of conspecific pollen deposited in stigmas and the amount of heterospecific pollen [@tur_evaluating_2016]. 
The higher the deposition of conspecific pollen relative to heterospecific, the larger the slope of that relationship.
On the other, we could also expect a larger amount of conspecific pollen deposited in stigmas when flowers are open to animal pollinators than is deposited due to self-pollination. 
**Second**, we investigate the relative contribution that four ecological factors have on the pollination service. 
Sepecifically, we hypothesize that competition (measured as absolute and relative conspecific pollen deposition) should increase for plants that share many pollination partners.
However, we also hypothesize that other factors like the plant's functional originality, its relative abundance, and the visit effectiveness should have the potential to compensate for this increase in competition. 
**Third**, we examine how community context influences the way plants use these factors to minimise competition. 
Although some plant species might be widespread across multiple locations, competition for pollinators occurs at the community level and hence we predict the competition for pollination niche to be influenced by the local context. 
If plant strategy is not flexible across communities (TODO: ref needed), we could expect niches to be more similar within species than across species in the study. 
On the contrary, if a species' strategy is flexible, we should expect plants to be able to occupy different niches in each community such that competition could be minimised regardless of the context. 

# Methods

We collected data from eleven co-flowering plant communities and their pollinators in three locations in the Argentinian Pampas. 
These locations are distributed across a precipitation gradient with a humid temperate climate in the eastern Flooding Pampas and becoming drier as one moves inland and westward towards the Pampean Grasslands. 
This precipitation gradient generatesd a natural gradient of network architecture which allowed us to examine the generality of our findings. 
In each location, we sampled two restored and two agricultural fragments, except in the Flooding Pampas, where we were only able to sample one restored fragment due to the lack of available sites.

## Competition vs. facilitation

Our first objective was to identify whether the outcome of plants sharing polinators at the community level is facilitation or competition. 
The first line of evidence can be found via the relationship between heterospecific and conspecific pollen deposited in plant stigmas [@tur_evaluating_2016]. 
This is because heterospecific pollen can be seen as an unavoidable cost that plants must pay for receiving conspecific pollen from shared pollinators. 
A negative relationship (when shared pollinators increase heterospecific pollen loads and decrease conspecific loads) may indicate that competition for pollination is strong. 
This negative relationship could arise, for example, when another, more dominant species, monopolizes a limited number of pollinators [@mitchell_new_2009; @lopezaraizamikel_impact_2007], when heterospecific pollen deposited in the stigma interferes with deposition of conspecific pollen [@runquist_pollinator-mediated_2012], or when conspecific pollen is lost to heterospecific stigmas [@mitchell_new_2009; @muchhala_interspecific_2012]. 
In contrast, a positive relationship is what would be observed when facilitation is the dominant outcome. 
For example, when the abundance of shared pollinators is positively influenced by floral resources, these positive effects ripple through the mutualistic network in a chain of positive feedback loops [@liao_presence_2011]. 

The second line of evidence can be obtained by examining the difference between the amount of conspecific pollen deposited in flower stigmas *with* and *without* animal-mediated pollination. 
Self-pollination can be favourable to plant reproduction when competition for pollination is strong because it provides insurance against poor pollination service [@kalisz_benefits_2003]. 
If competition for pollination is sufficiently strong, then the amount of conspecific pollen deposited in flower stigmas when animal pollination is prevented could be higher than when floral visits are allowed. 
In contrast, the opposite pattern may indicate that plants benefit from having pollen delivered directly to the stigma by animals. 
We did not specifically test the effect of pollen viability or the extent to which self-pollen vs. pollen from a conspecific may differ in their value for fertilization which can be important factors (TODO: ref needed). 
However, it is reasonable to expect that the difference between outcross and self-pollen may be generally relevant and particularly so for species that are not self-fertile or those in which self-fertilization is rarely effective due to a temporary separation in the maturation of the sexes (dichogamy) (TODO: ref needed). 

### Data collection

In each of the studied communities, we quantified pollen deposition in a subset of plant species between December 2010 and February 2011. 
This subset comprised between three and nine common insect-pollinated (entomophilous) plant species that were flowering during the sampling period (see Figure \@ref(fig:fig-trade-off-predictions)a). 
We chose plant species such that they cover a wide range on a specialization-generalization gradient as well as a wide range of abundances. 
Briefly, in each of the selected plants, we removed all flowers leaving only buds that were expected to go into florescence on the next day. 
Approximately a quarter of these buds were bagged to prevent animal pollination. 
Two days after inflorescence, we counted the pollen grains in the remaining flowers' pistils, classified them between conspecific and heterospecific pollen, and calculated the number of pollen grains per stigma in each flower. 
More details about the study sites, data collection, and laboratory protocols can be found in @marrero_agricultural_2016. 

### Data analysis

To evaluate the relationship between heterospecific and conspecific pollen, we used a generalised linear mixed model (GLMM) with a Poisson error distribution [@tur_evaluating_2016]. 
In this model, the number conspecific pollen grains per stigma was the response variable and the number of heterospecific grains the predictor (the number of stigmas sampled from the flower was added as an offset term). 
The slope and intercept of this relationship were allowed to differ between plant species within each community, which were modelled as a random effect. 
Models were fitted using the function `glmer` from the R package `lme4 1.1-19` [@bates_fitting_2015]. 
To compare the conspecific pollen deposited with and without animal-mediated pollination, we followed the same approach as above. 
In this case, however, the predictor was the treatment (wether the flower was bagged or unbagged) instead of the number of heterospecific grains. 

## Ecological constraints the pollination service 

Our second objective was to investigate the relative contribution of different factors that describe the plant competition for pollination niche to the pollination service. 
Specifically, we investigated the effect of (*i*) a plant's number of shared pollinator species, (*ii*) a plants abundance relative to the rest of the community, (*iii*) the mean visit effectiveness---a metric that combines the share of pollen that a plant species is able to place on each of their floral visitors and the number of visits it receives from them (see *Data Analysis* section below for more details), and (*iv*) the plants functional originality (add ref). 
<!-- Here, we define visit effectiveness of the pollinator species *i* to plant species *j* as the proportion between the visits of *i* to *j* and all visits of *i*, multiplied by the proportion between the number of pollen grains of *j* attached to individuals of *i* and all pollen attached to individuals of *i*. -->

### Data collection

To obtain the number of shared pollinators for each species, we collected data to construct qualitative and quantitative pollination networks. 
Qualitative networks were constructed based on two-hour observations of floral visits in each fragment. 
Quantitative networks were constructed using two 50 m randomly located transects in each fragment. 
We counted and collected all floral visitors found in a 2 m wide strip while walking at a pace of 10 m per minute [@marrero_effect_2014; @memmott_structure_1999]. 
We visited the transects each month between November 2010 and March 2011. 
To obtain plant abundance, we counted all units of floral attraction found during an independent sampling of the transects used to construct the quantitative visitation networks. 
To estimate visit effectiveness we need to construct pollen transfer networks in addition to the visitation networks. 
To construct the transfer networks, we examined the pollen loads present on the floral visitors collected [@marrero_exotic_2017]. 
When the pollen count on an individual animal was estimated to be less than 2,000 grains, we identified every grain to the species level when possible and to pollen complexes when it was not. 
When the pollen count was above 2,000 grains, we classified approx. 50% of pollen and total pollen counts were extrapolated [@bosch_plant-pollinator_2009]. 
Finally, we also recorded morphological traits that relate to plant type (herb, shrub, climber), life cycle (annual, perennial), flower colouration, phenology, and whether the species is native in the study region. 
We used those traits because they were the only ones available... (TODO: Add a better justification for the traits used)
More details about the study sites, data collection, and laboratory protocols can be found in Marrero *et al.* (2014 and 2017).

### Data analysis

We investigated the impact of the ecological factors on pollination services.
Generally speaking, the more conspecific pollen deposited in stigmas, both absolutely and relative to heterospecific pollen, the better the pollination service. 
Specifically, we used two sets of linear mixed models (LMM) in which the response variables are the number of conspecific and heterospecific pollen grains deposited per stigma in flowers open to animal-mediated pollination. 
In general, using LMMs in which pollen loads were log-transformed (Figure \@ref(S-fig:fig-deposition-gain-log-transformed-or-not)) offered better fit than a GLMM with Poisson (or quasipoisson) error structure. 
Models were fitted using the R package `nlme 3.1-131` [@pinheiro_nlme_2018]. 

Because the amount of deposited pollen can vary widely across species, and potentially also across communities, we evaluated two possible structures for the random effects: one that includes a random intercept for plant species, and one that treats measures from species across different communities as independent. 
We selected the best random structure by comparing the median Akaike Information Criterion for small samples (AICc). 

As predictors in the models, we included the four ecological variables described above. 
Specifically, we calculated the number of shared pollinators for each plant species by pooling data from the qualitative and quantitative pollination networks. 
<!-- This variable is strongly correlated to the number of animal species a plant interacts with (the species degree).  -->
To calculate the plants' relative abundance in their community, we simply aggregated floral counts for each species. 
We then calculated the mean visit effectiveness. 
We define the effectiveness of a visit by pollinator species *i* to plant species *j* as \[e_{ij} = \frac{v_{ij}}{v_i} \frac{p_{ji}}{p_j}\] where *v~ij~* is the observed number of visits by *i* to *j*, *p~ji~* is the number of pollen grains from *j* attached to *i*, *v~i~* is the total number of visits performed by *i*, and *p~j~* is the total number of grains carried by *j*.
Because the number of shared pollinators, floral abundance, visitation, and pollen production roughly followed a power-law distribution, we log-transformed these three predictors before including them in the model. 

Finally, functional originality is defined as the distance of a species from the community trait average--the centroid of functional space of the community [@laliberte_distance-based_2010; @coux_linking_2016]. 
<!-- As phenology has been shown to be a key mechanism of niche differentiation among plants, we also  -->
To include phenology we treated plant abundance in each of the survey months (November to March) as a "trait" in our analysis. 
<!-- This approach allowed us to integrate the originality in phenological niche alongside the originality on other functional traits.  -->
Then we assigned the abundances a weight of 1/5 compared to other functional traits, this accounted for the non-independence of floral counts across months and effectively weights phenology equally to other traits. 
We scaled all traits prior to calculating the centroid of the functional space and calculated the species-specific functional coordinates using the R package `FD 1.0-12` [@laliberte_fd_2014]. 
Finally, to facilitate comparison across the four continuous explanatory variables in our models, we rescaled them all to have a zero mean and unitary variance.

To estimate the coefficients and to perform model selection and quantify the associated uncertainty, we used a combination of multi-model inference and bootstrap resampling with one hundred replicates. 
First, we performed model selection using the AICc and determined the likelihood of each candidate model (a particular combination of predicting variables) by calculating the median \(\Delta\)AICc (relative to the most likely model) for each bootstrap sample. 
As we wanted model coefficients from more likely candidate models to carry more weight in our results, we sampled the coefficients for our variables proportional to the likelihood of its candidate model. 
We "shrank" the estimated coefficient of potentially unimportant variables by setting their estimate to 0 when the variable was not included in the model. 
Finally, we used these distributions of the model coefficients to estimate their mean impact on the pollination service (in terms of absoulte and relative conspecific pollen deposition). 
Again, here we used bootstrap resampling to estimate the uncertainty around these means. 

## Flexibility of plant strategies

Our last objective was to tease apart the plant strategies that might reduce competition and, importantly, how the community context influences these strategies. 
If community context plays a relatively small role or the species strategy is inflexible we would expect plants of the same species to fill similar competition for pollination niches across different communities. 
Alternatively, if the community plays a large role and plants sttrategies are flexible, we should be able to observe differences in the niche a plant species occupies across communities. 
First, we used a principal component analysis (PCA) of the four ecological variables. 
We scaled variables across the whole study to ensure that the PCA space does not change acording to the species present in each community. 
We define a species' niche in a community as its coordinates in PCA space. 
For each species that was present in two or more communities, we then calculated (*i*) the median distance between the strategies that the species uses in different communities and (*ii*) the area of the convex hull defined by these points in the first two principal components (only for species present in three or more communities). 
We then compared the magnitude of these two metrics to those obtained with 99 Monte Carlo randomizations in which we replaced the strategy of the focal plant species by that of another randomly selected species in the dataset. 

# Results

## Competition vs. facilitation

```{r facilitation-random-model-stats, echo = F}
drake::loadd(facilitation_plot_df)

# count number of species with positive and negative slopes
counts_facilitation_slope <- facilitation_plot_df %>%
  dplyr::group_by(effect_category) %>%
  dplyr::count() %>%
  dplyr::group_by() %>%
  dplyr::mutate(np = nn/sum(nn), 
                np = round_preserve_sum(np, 2)*100)

# species with both positive and negative relationships
get_sp_with_both_pos_neg <- . %>%
  dplyr::filter(effect_category != "neutral") %>%
  dplyr::group_by(plant_name) %>%
  dplyr::summarise(both = dplyr::n_distinct(effect_category) > 1) %>%
  dplyr::filter(both)

# Get list of species with both positive and negative slopes
sp_both_pos_neg <- facilitation_plot_df %>%
  get_sp_with_both_pos_neg() %>%
  dplyr::mutate(plant_name = as.character(plant_name)) %>%
  dplyr::arrange(plant_name) %>%
  dplyr::mutate(plant_name = stringr::str_extract(plant_name,
                                                  "[A-Z]\\w+\\s[a-z]\\w+"), 
                plant_label = paste0("*", plant_name, "*")) 
# Human readable list of species with both positive and negative slopes
sp_both_pos_neg_names <- sp_both_pos_neg %$%
  glue::collapse(plant_label, sep = ", ", last = ", and ")

# equal number of negative and positive?
equal_pos_neg <- counts_facilitation_slope$nn[1] == counts_facilitation_slope$nn[3]
```

We first examined the degree of facilitation/competition in natural communities. Specifically, we examined the slope of the relationship between the heterospecific and conspecific pollen deposited on stigmas of each species in a community. 
We found that overall neither facilitation nor competition dominates (Table \@ref(S-tab:table-facilitation-models-general)). 
Indeed, we found that the proportion of species that experienced a significantly positive or neggative relationship between heterospecific and conspecific pollen than neggative was very similar (`r counts_facilitation_slope$np[3]`% and `r counts_facilitation_slope$np[1]`%, respectively; Figure \@ref(fig:fig-trade-off-predictions)a; Table \@ref(S-tab:table-facilitation-models-random)). 
Most of the variation between plants in a facilitation-competition gradient was driven by differences *between* species; however, we also observed some important differences *within* species. 
For instance, `r numbers2words(nrow(sp_both_pos_neg))` of the species sampled across multiple communities (`r sp_both_pos_neg_names`) showed evidence that, the same species, can experience facilitation (positive relationships) in some communities and competition (negative relationships) in others. 
Interestingly, although there was a wide variation in the slope of the relationship between heterospecific and conspecific pollen almost all plants had more conspecific than heterospecific pollen deposited on their stigmas (Figure \@ref(fig:fig-trade-off-predictions)b). 

```{r fig-trade-off-predictions, fig.height= 4, fig.width = 6.5, fig.cap = "**Competition vs. facilitation at the community level**. (a) Some species experience more competition for pollination than others. Points indicate the estimated slopes for the relationship between the amount of heterospecific and conspecific pollen deposited per stigma across species in their communities. Significantly negative slopes (dark grey) indicate that plants experience competition for animal-mediated pollination, while significantly positive slopes (light grey) indicate that facilitation is the predominant outcome. The number of plants analysed for each species is shown within brackets next to the species name. (b) Despite the variety of slopes, overall plants had more conspecific than heterospecific pollen deposited in their stigmas. (c) Generally, plants also had more pollen deposited in their stigmas when they were open to animal-mediated pollination than when they were closed. In all plots, error bars correspond to $\\pm$ the standard error (SE)."}
# fig_random_slopes <- plot_random_slopes(facilitation_plot_df)
# fig_con_con <- plot_bagged_vs_open_conspecific(dep_frame)
# fig_hetero_con <- make_fig_con_hetero_empirical(dep_frame)
# pdf(width = 6.5, height = 4)
drake::loadd(fig_random_slopes)
drake::loadd(fig_con_con)
drake::loadd(fig_hetero_con)
width_left <- 6.5*3/5
bar_plot_width <- 0.325
rw <- c(width_left - bar_plot_width,
        bar_plot_width, 
        6.5 - width_left - bar_plot_width,
        bar_plot_width)
left <- cowplot::plot_grid(
  fig_hetero_con,
  NULL,
  fig_con_con[[1]],
  fig_con_con[[2]],
  ncol = 2, 
  rel_widths = rw[c(3,4)], 
  align = "h"
)
right <- cowplot::plot_grid(
  fig_random_slopes[[1]],
  fig_random_slopes[[2]], 
  # ncol = 2, 
  align = "h", 
  rel_widths = rw[1:2]
)
cowplot::plot_grid(
  right,
  left,
  ncol = 2,
  rel_widths = c(sum(rw[1:2]), sum(rw[3:4]))
)
# dev.off()
```

```{r facilitation-conspecific-stats}
drake::loadd(con_con_plot_df)
# overall counts of possitive/negative
sp_con_con <- con_con_plot_df %>%
  dplyr::group_by(effect_category) %>%
  dplyr::count() %>%
  dplyr::group_by() %>%
  dplyr::mutate(np = n/sum(n), 
                np = round_preserve_sum(np, 2)*100)
# species with contrasting behaviours
sp_con_both_pos_neg <- con_con_plot_df %>%
  get_sp_with_both_pos_neg() %>%
  dplyr::arrange(plant_name) %>%
  dplyr::mutate(plant_label = dplyr::if_else(plant_name %in% sp_both_pos_neg$plant_name, shorten_sp_name(plant_name), plant_name),
                plant_label = paste0("*", plant_label, "*"))
```

Second, we compared the amount of conspecific pollen deposited on flowers that were open to animal-mediated pollinators with that of those that were closed. 
Here, we again found large differences between plants but with a clear tendency to find more pollen in open flowers (Table \@ref(S-tab:table-open-bagged-models-general)). 
Specifically, `r sp_con_con$np[sp_con_con$effect_category == "positive"]`% of plants had significantly more pollen when open and `r sp_con_con$np[sp_con_con$effect_category == "negative"]`% had significantly less pollen when open (the difference was non-signifcant for the remainding `r sp_con_con$np[sp_con_con$effect_category == "neutral"]`%; Figure \@ref(fig:fig-trade-off-predictions)c; Table \@ref(S-tab:table-open-bagged-models-random)). 
Variation within species was slightly smaller and only `r numbers2words(nrow(sp_con_both_pos_neg))` species (`r glue::collapse(sp_con_both_pos_neg$plant_label, sep = ", ", last = ", and ")`) had both significantly positive and negative differences. 

## Ecological constraints in the pollination service 

```{r model-fit-statistics}
drake::loadd(model_formula_ranking, glanced_fixed)

r2_values <- model_formula_ranking$by_model_set %>%
  dplyr::filter(grepl("abs", pollen_category)) %>% 
  dplyr::group_by(pollen_category) %>%
  dplyr::filter(delta_AIC_median == min(delta_AIC_median)) %>%
  dplyr::select(fixed_formula, pollen_category, scale) %>%
  dplyr::left_join(glanced_fixed) %>% 
  dplyr::select(r2m, r2c) %>%
  dplyr::summarise_all(dplyr::funs(min, median, mean, max)) %>%
  dplyr::mutate_if(is.numeric, round, digits = 2)
```

We then examined the potential roles played by four ecological variables (number of shared pollinators, abundance, mean visit effectiveness, and functional originality) play in pollen deposition and, by extension, in the quantity and quality of pollination. 
Together these variables can describe the niche that plants might occupy in the context of competition for pollination. 
We found that our linear mixed models of pollen deposition had high explanatory power. 
The conditional coefficient of determination R^2^~(c)~ of the most parsimonious models (those with the lowest AICc) ranged between `r r2_values$r2c_min[r2_values$pollen_category == "conspecific_abs"]` and `r r2_values$r2c_max[r2_values$pollen_category == "conspecific_abs"]` (mean of `r r2_values$r2c_mean[r2_values$pollen_category == "conspecific_abs"]`) for the bootstrap replicates of the conspecific pollen models and between `r r2_values$r2c_min[r2_values$pollen_category == "heterospecific_abs"]` and `r r2_values$r2c_max[r2_values$pollen_category == "heterospecific_abs"]` (mean `r r2_values$r2c_mean[r2_values$pollen_category == "heterospecific_abs"]`) for the models of heterospecific pollen [@nakagawa_general_2013]. 
A large portion of this explanatory power came from the random effects, particularly for models of conspecific pollen. 
The marginal coefficient of determination R^2^~(m)~, which describes the proportion of variance explained by just the fixed effects, ranged between `r r2_values$r2m_min[r2_values$pollen_category == "conspecific_abs"]` and `r r2_values$r2m_max[r2_values$pollen_category == "conspecific_abs"]` (mean `r r2_values$r2m_mean[r2_values$pollen_category == "conspecific_abs"]`) for the conspecific models and between `r r2_values$r2m_min[r2_values$pollen_category == "heterospecific_abs"]` and `r r2_values$r2m_max[r2_values$pollen_category == "heterospecific_abs"]` (mean `r r2_values$r2m_mean[r2_values$pollen_category == "heterospecific_abs"]`) for the heterospecific models. 

We tested two structures for the random effects. 
As determined by AICc, the random structure best supported by the data was the one that fit an intercept for each species in each community (as opposed to a common intercept for each species irrespective of the community they belong to). 
This structure was best for both the models of conspecific and heterospecific pollen (Table \@ref(S-tab:table-aic-random-models)).  

Of the four variables we considered, we found that a plant's mean visit effectiveness and abundance were the most important ecological variables predicting pollen deposition in plant stigmas (Figure \@ref(fig:fig-average-qual-quant)a). 
Surprisingly, the number of shared pollinators was comparatively unimportant, particularly for models of heterospecific pollen deposition, as it was only ever included in models with relatively large AICc values (\@ref(S-tab:table-aic-fixed-models)). 

```{r fig-average-qual-quant, fig.height= 2.29*2, fig.width=6.5/3*2, fig.cap="**Effect of strategies to minimise competition in the pollination service**. (a) The plant's visit effectiveness and relative abundance are the most important variables determining the deposition of conspecific and heterospecific pollen. Meanwhile, the number of shared pollinators was relatively unimportant. The graph shows the relative variable importance calculated as the sum of the Akaike weights of the candidate models that included the variable. (b) The association of ecological variables on heterospecific pollen tended to be aligned with its association on conspecific pollen. Visit effectiveness and functional originality had a positive association with pollen deposition, while abundance and the number of shared pollinators had a negative association. The plot shows the distribution of the effects (across 99 bootstrap replicates) of the four ecological variables for conspecific (top panel) and heterospecific pollen (bottom panel). Results are only shown for models that included explanatory variable. (c) The end result of these associations is that only the plants' functional originality has a positive impact on both the quantity and quality of pollination. The plot shows the model averaged mean effect ($\\pm$ SE) of the four analysed ecological variables in the quantity and quality of pollination."}
height1 <- 1
height2 <- 1.29
# pdf(width = 3.25 * 2 / 3 * 2, height = sum(c(height1, height2))*2)
# fig_coef_avg <- plot_coefficient_averages(coefficient_averages, variable_importance)
width_imp <- 6.5/5*2
mult <- 2.455 # for 2/3 is xx, for 3/5 is 2.355
width_coef_1 <- (6.5 - width_imp) / (1 + mult)
width_coef_2 <- 5.6 - width_imp - width_coef_1
# fig_var_importance <- plot_variable_importance(variable_importance)
drake::loadd(fig_var_importance)
drake::loadd(fig_coef_avg)
drake::loadd(fig_coefficient_averages)

left_top <- cowplot::plot_grid(
  fig_var_importance[[1]],
  fig_var_importance[[2]],
  ncol = 2, 
  align = "h"
)

left_bottom <- cowplot::plot_grid(
  fig_coef_avg[[1]],
  fig_coef_avg[[2]],
  rel_widths = c(width_coef_1, width_coef_2), 
  align = "h"
)

cowplot::plot_grid(
  left_top, 
  fig_coefficient_averages,
  left_bottom, 
  ncol = 1, 
  rel_heights = c(height1, height1 + height2, height2)
)

# dev.off()
```

We found that the relationship between each of the ecological factors and pollen deposition was similar for both conspecific and heterospecific pollen. 
That is, strategies that were associated with an increase in conspecific pollen were also associated with an increase in heterospecific pollen deposition. 
Specifically, the plants' mean visit effectiveness had a positive effect on pollen deposition (Figure \@ref(fig:fig-average-qual-quant)b). 
However, the effect size was slightly larger for heterospecific than for conspecific pollen. 
This indicates that, although there is a positive association between visit effectiveness and the *absolute* amount of conspecific pollen, there is a negative relationship with the *relative* amount of conspecific relative to heterospecific pollen (Figure \@ref(fig:fig-average-qual-quant)c). 
In contrast, a plants' relative abundance had a negative effect on the absolute amount of conspecific pollen, but the mean difference between the coefficients in the models indicates a positive association with the relatvie amount of conspecific pollen (Figure \@ref(fig:fig-average-qual-quant)c). 
The third most important variable, functional originality, had a positive, although comparatively smaller, association with both the absolute and relative amount of conspecific pollen deposited. 
Finally, the number of shared pollinators had a negative association with both the absolute and relative amounts of conspecific pollen deposited, but these impacts were small when compared to the other variables. 
Although relative abundance, the number of shared pollinators, and the visit effectiveness were all positively correlated (Figure \@ref(S-fig:fig-correlation)), the effect each had on conspecific pollen was relatively similar among models that included all or just some of these three explanatory variables (Figure \@ref(S-fig:fig-model-results)), indicating that collinearity did not influence our findings qualitatively. 

## Flexibility of plant strategies

```{r pca-stats}
drake::loadd(pcas)
chosen_threshold <- 0
this_pca <- pcas %>%
    purrr::keep(~ .$call$X$pca_type[1] == "across") %>%
    purrr::keep(~ .$call$X$threshold[1] == chosen_threshold) %>%
    extract2(1)
```

We used a PCA of the analysed species to investigate whether plants strategies are similar across communities or whether they are flexible, and therefore able to adapt to the community context. 
The first two PCA components explained `r round(this_pca$eig[2, 3])`% of the total variance (Figure \@ref(fig:fig-pca)a). 
The first component was dominated by changes in the visit effectiveness and the relative abundance, while the second component was dominated by the number of shared pollinators and the plant's functional originality. 
When we locate the species that were sampled in more than one community in the first two PCA components (Figure \@ref(fig:fig-pca)b), we observe that the strategies of a species do not seem to be close to each other. 
Indeed, when we measured the median distance between the plants coordinates, we found that it was significantly smaller than that of randomisations for only one of all analysed species (Figure \@ref(fig:fig-pca)c). 

```{r strategy-fig-height}
height0 <- 1.55
height1 <- 2.7
height2 <- 2.4
strategy_fig_height <- sum(height0, height1, height2)
```

```{r fig-pca, fig.width=3.25, fig.height=strategy_fig_height, fig.cap="**The flexibility of plant strategies**. (a) The two first components explain a large proportion of the total variance. (b) When plants that were sampled in more than one community are plotted with these two components, we observe that points, which represent the strategy (the particular combination of ecological variables) of a species in a community do not seem to be grouped by plant species. (c) This was confirmed using Monte Carlo randomizations of the median distance between strategies of a plant species. Only one of the examined species had strategies that were more tightly connected than what would be expected at random."}
# fig_pca <- plot_pca(pcas, chosen_threshold = 0)
# fig_distances <- plot_permanova_dist(permanova_plant_distances, permanova_site_distances)
# fig_pca_contrib <- plot_pca_variances_and_contributions(pcas, chosen_threshold = 0)
# pdf(width = 3.25, height = strategy_fig_height)
drake::loadd(fig_pca_contrib)
drake::loadd(fig_pca)
drake::loadd(fig_distances)
cowplot::plot_grid(
  fig_pca_contrib,
  fig_pca, 
  fig_distances,
  ncol = 1, 
  rel_heights = c(height0, height1, height2), 
  align = "v"
)
# dev.off()
```

# Discussion 

Our results suggest that the community context plays a central role in determining competition for pollination. 
First, we found that the costs of pollinator sharing are pervasive. In particular, we found that a significant proportion of species undergoes overall neutral or competitive effects from animal-mediated pollination. 
Second, we found that plants are able to minimise the intensity of this competition using multiple strategies, however, conspecific and heterospecific pollen deposition are tightly coupled and therefore these strategies are likely to involve a trade-off between the quantity and quality of pollination. 
Third, we found that these strategies are strongly shaped by the community context, this is, the same plant species can adopt dramatically different strategies depending on the community it belongs to. 

\R{disc-facil-comp}Both of the tests we used to identify the effect of animal-mediated pollination suggested the same outcome: that overall facilitation is only experienced by a minority of species in a community. 
Although a recent study already suggested a wide range of outcomes in a multi-species context [@tur_evaluating_2016], the factors determining why some species experience more competition than others were not understood. 
Here we show that the prevalence of neutral and competitive effects of animal-mediated pollination can be, at least partially, explained by the trade-offs that minimising competition involves.  

These trade-offs were most evident precisely in the strategies that most strongly modulate pollen deposition. 
We found that the strategies that increased the relative dominance of the species (in terms of pollen and visits, or abundance) also tended to be the most important predictors of pollen deposition. 
Adopting a strategy of high visitation increases the rates of conspecific pollen deposition at the expense of a reduction in the quality of pollination even when the visitors carry a high proportion of conspecific pollen. 
Similarly, adopting a strategy of high abundance reduces the amount of heterospecific pollen deposited but at the expense of a noticeable reduction in the amount of conspecific pollen. 
Our results corroborate the importance that previous studies have attributed to the role that visitation and abundance play at determining competition for pollination [@feldman_when_2004; @munoz_presence_2008; @morales_interspecific_2008]. 
The fact that they also involve a trade-off between the quantity and quality of pollination might explain the often contrasting results that these studies, based on two or three species systems obtained. 

Simultaneously, because visitation, pollen production and abundance are correlated [@sargent_role_2006], the trade-offs also suggest that to minimise competition for pollination plants must reach a fine balance between increasing conspecific pollen and reduce heterospecific pollen deposition. 
The relatively wide range of coefficients in our models might be explained by the large variation of the extent to which plant species are affected by pollen deposition. 
While some plant species experience a large reduction on seed set due to heterospecific pollen deposition, some others are relatively insensitive to heterospecific pollen but are greatly affected by low levels of conspecific pollen deposition [@campbell_mechanism_1985]. 

The two other strategies we analysed involved a smaller trade-off than the abundance or visit efficacy. 
Specifically, having high functional originality relative to other species in the community or sharing few pollinators was found to be beneficial to both the quantity and quality of pollination.
Interestingly, these two strategies also had lower explanatory power in the models of pollen deposition. 
This does not necessarily imply that these variables are unimportant to pollen deposition. 
Instead, it is possible that the processes that underlay these strategies might be more complex than what our metrics are able to capture. 
Particularly so for conspecific pollen deposition, which was harder to predict than heterospecific pollen. 
For instance, having distinct traits, for example through phenology differentiation, might have a positive impact on the pollination service only to the extent to which previous floral communities have promoted high pollinator densities (ref). 
In addition, some plants have been shown possess mechanisms that prevent heterospecific pollen deposition even when shared visitors carry pollen loads from diverse species. 
Alternatively, other factors that we were unable to measure, like pollinator behaviour and densities [@ye_competition_2014; @flanagan_effects_2011; @melissas_2019?] or the spatial context [@cariveau_spatially_2009], can also shape the way sharing pollinators affect the pollination service. 

\R{strategies}Regardless of the specific factors involved it is clear, however, that the community context has a very important effect on the way plant species respond to competition for pollination. 
First, in the models of pollen deposition, the random structure that allowed plants of the same species to have different intercepts across communities was much better supported by the data than the structure that fixed the intercept for a plant species irrespective of the community. 
Second, in a large majority of cases, the strategies that a species uses across communities are not more similar to each other than what would be expected at random. 
Lit? Context?

## Conclusion

Here we show that competition for pollination is pervasive in ecological communities and that its effect on plant species strongly influenced by the community context. 
Our results suggest that at the community level, the strategies that plants adopt to minimise competition require reaching a fine balancing act between the quantity and quality of pollination. 
In particular, strategies that promote dominance of the species in its community (in terms of abundance, visitation and participation in the pollen pool) had the largest impacts on pollen deposition but also the largest trade-offs between increasing deposition of conspecific pollen and reducing that of heterospecific pollen. 
Contrastingly, strategies that increase niche differentiation (functional originality and specialization) were positive to both the quantity and quality of pollination, but its effect was comparatively small compared to strategies of dominance.
Remarkably, the particular strategy a plant uses is strongly shaped by its context and hence can be dramatically different in each of the communities it is part of. 
[Wider application? Catchy closing line ideas?]

# Acknowledgements

`r paste(drake::readd(acknowledgements), collapse = "")`

# References
